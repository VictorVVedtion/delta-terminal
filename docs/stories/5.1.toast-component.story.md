# Story 5.1: Toast 即时通知组件

## Status

**Completed** ✅

---

## Story

**As a** 用户,
**I want** 在执行操作后立即看到结果反馈,
**so that** 我知道操作是否成功。

---

## Acceptance Criteria

1. [x] 安装 Sonner 依赖
2. [x] 在 layout.tsx 添加 Toaster Provider
3. [x] 创建 `lib/toast.ts` 封装 toast 函数
4. [x] 支持 success/error/warning/info 四种类型
5. [x] 支持自定义持续时间
6. [x] 支持带操作按钮的 Toast
7. [x] Toast 样式与 RiverBit 设计一致
8. [x] TypeScript 类型安全检查通过

---

## Tasks / Subtasks

- [x] **Task 1: 安装依赖** (AC: 1)
  - [x] `pnpm add sonner`

- [x] **Task 2: Provider 设置** (AC: 2)
  - [x] 在 RootLayout 添加 Toaster
  - [x] 配置默认样式

- [x] **Task 3: Toast 封装** (AC: 3, 4, 5, 6)
  - [x] 创建 `lib/toast.ts`
  - [x] 封装 success/error/warning/info
  - [x] 添加类型定义

- [x] **Task 4: 样式定制** (AC: 7)
  - [x] 定制 RiverBit 颜色
  - [x] 添加图标

---

## Dev Notes

### Sonner 安装

```bash
pnpm add sonner
```

### Layout 配置

```tsx
// app/layout.tsx
import { Toaster } from 'sonner'

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        {children}
        <Toaster
          position="top-right"
          richColors
          closeButton
        />
      </body>
    </html>
  )
}
```

### Toast 封装

```typescript
// lib/toast.ts
import { toast as sonnerToast } from 'sonner'

export const toast = {
  success: (title: string, options?: ToastOptions) => {
    sonnerToast.success(title, {
      description: options?.description,
      duration: options?.duration ?? 5000,
      action: options?.action,
    })
  },

  error: (title: string, options?: ToastOptions) => {
    sonnerToast.error(title, {
      description: options?.description,
      duration: options?.duration ?? 8000,
      action: options?.action,
    })
  },

  warning: (title: string, options?: ToastOptions) => {
    sonnerToast.warning(title, {
      description: options?.description,
      duration: options?.duration ?? 6000,
    })
  },

  info: (title: string, options?: ToastOptions) => {
    sonnerToast.info(title, {
      description: options?.description,
      duration: options?.duration ?? 5000,
    })
  },
}

interface ToastOptions {
  description?: string
  duration?: number
  action?: {
    label: string
    onClick: () => void
  }
}
```

### 使用示例

```typescript
import { toast } from '@/lib/toast'

// 成功
toast.success('部署成功', {
  description: 'RSI 反弹 已部署到 Paper 模式',
})

// 错误带重试
toast.error('部署失败', {
  description: '网络错误',
  action: {
    label: '重试',
    onClick: () => handleRetry(),
  },
})

// 警告
toast.warning('风险警告', {
  description: '止损比例超过 10%',
})
```

---

## Dependencies

- Sonner 库

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-25 | 1.0 | 初始 Story 创建 | YOLO Agent |
