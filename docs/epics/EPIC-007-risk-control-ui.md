# Epic 007: é£æ§UIå¢å¼º - Brownfield Enhancement

> åŸºäº V3 è®¾è®¡æ–‡æ¡£åœºæ™¯ S29/S31/S44ï¼Œæ‰©å±•ç°æœ‰å®‰å…¨ç³»ç»Ÿçš„å¯è§†åŒ–å’Œäº¤äº’åŠŸèƒ½

---

## Epic å…ƒæ•°æ®

| å±æ€§ | å€¼ |
|------|-----|
| Epic ID | EPIC-007 |
| åç§° | é£æ§UIå¢å¼º (Risk Control UI Enhancement) |
| ç±»å‹ | Brownfield Enhancement |
| ä¼˜å…ˆçº§ | P1 (å®‰å…¨å¢å¼ºåŠŸèƒ½) |
| é¢„ä¼° Stories | 3 |
| åˆ›å»ºæ—¥æœŸ | 2025-12-26 |
| V3 è®¾è®¡å‚è€ƒ | `S29 ç†”æ–­å™¨UI`, `S31 å®¡æ‰¹å·¥ä½œæµ`, `S44 æç«¯è¡Œæƒ…å¤„ç†` |
| å‰ç½®ä¾èµ– | EPIC-008 (Safety Critical) âœ…, EPIC-004 (Risk Management) âœ… |

---

## Epic Goal

**åœ¨å·²æœ‰çš„å®‰å…¨æœºåˆ¶åŸºç¡€ä¸Šï¼Œæä¾›æ›´ç›´è§‚çš„å¯è§†åŒ–ç•Œé¢å’Œæ›´å®Œå–„çš„ç”¨æˆ·äº¤äº’æµç¨‹ï¼Œå¢å¼ºç”¨æˆ·å¯¹é£é™©æ§åˆ¶åŠŸèƒ½çš„ç†è§£å’Œæ“ä½œä½“éªŒã€‚**

æ ¸å¿ƒå¢å¼ºï¼š
1. **ç†”æ–­å™¨å¯è§†åŒ–UI** - ç†”æ–­çŠ¶æ€å®æ—¶å±•ç¤ºã€æ‰‹åŠ¨é‡ç½®ã€å†å²è®°å½•
2. **å®¡æ‰¹å·¥ä½œæµä¼˜åŒ–** - å¤šçº§å®¡æ‰¹æµç¨‹å¯è§†åŒ–ã€å®¡æ‰¹å†å²è¿½è¸ª
3. **æç«¯è¡Œæƒ…å¤„ç†** - å¸‚åœºå¼‚å¸¸æ£€æµ‹ã€è‡ªåŠ¨é˜²æŠ¤ã€ç´§æ€¥é€šçŸ¥

---

## ç°æœ‰ç³»ç»Ÿä¸Šä¸‹æ–‡

### å·²æœ‰ç»„ä»¶

| ç»„ä»¶ | è·¯å¾„ | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| SafetyStore | `store/safety.ts` | å®‰å…¨çŠ¶æ€ç®¡ç† (å«ç†”æ–­ã€å®¡æ‰¹) | âœ… å®Œæˆ |
| KillSwitch | `components/safety/KillSwitch.tsx` | ç´§æ€¥åœæ­¢æŒ‰é’® | âœ… å®Œæˆ |
| MarginAlert | `components/safety/MarginAlert.tsx` | ä¿è¯é‡‘é¢„è­¦ | âœ… å®Œæˆ |
| NotificationCenter | `components/system/NotificationCenter.tsx` | é€šçŸ¥ä¸­å¿ƒ | âœ… å®Œæˆ |
| ToastNotification | `components/system/Toast.tsx` | Toast é€šçŸ¥ | âœ… å®Œæˆ |

### ç°æœ‰æ•°æ®ç»“æ„

```typescript
// å·²åœ¨ store/safety.ts ä¸­å®šä¹‰
interface CircuitBreakerStatus {
  triggered: boolean
  triggerReason?: CircuitBreakerTrigger
  triggeredAt?: number
  resumeAt?: number
  currentDailyLoss: number
  currentHourlyLoss: number
  consecutiveLosses: number
  canResume: boolean
}

interface ApprovalState {
  currentStep: ApprovalStep
  completedSteps: ApprovalStep[]
  riskAcknowledged: boolean
  capitalConfirmed: boolean
  approvalToken?: string
  expiresAt?: number
}

interface ApprovalRecord {
  id: string
  strategyName: string
  capitalUsed: number
  approvedAt: number
  approverAction: string
}
```

---

## åŠŸèƒ½è®¾è®¡

### S29: ç†”æ–­å™¨UIå¯è§†åŒ–

**ç°çŠ¶**: SafetyStore å·²å®ç°ç†”æ–­é€»è¾‘ï¼Œä½†ç¼ºå°‘ç”¨æˆ·ç•Œé¢å±•ç¤º

**å¢å¼ºå†…å®¹**:
- ç†”æ–­çŠ¶æ€å®æ—¶å±•ç¤ºï¼ˆè§¦å‘åŸå› ã€æ¢å¤å€’è®¡æ—¶ï¼‰
- ç†”æ–­å†å²è®°å½•ï¼ˆæœ€è¿‘ 10 æ¬¡ï¼‰
- æ‰‹åŠ¨é‡ç½®æ§åˆ¶
- ç†”æ–­è§¦å‘æ—¶çš„æ˜¾è‘—è§†è§‰åé¦ˆ

**éªŒæ”¶æ ‡å‡†**:
- ç†”æ–­è§¦å‘æ—¶è‡ªåŠ¨å¼¹å‡ºè¯¦æƒ…é¡µ
- æ˜¾ç¤ºè§¦å‘åŸå› å’Œè§¦å‘æŒ‡æ ‡å€¼
- å€’è®¡æ—¶æ¢å¤æ—¶æ˜¾ç¤ºå‰©ä½™æ—¶é—´
- æä¾›å¼ºåˆ¶æ‰‹åŠ¨é‡ç½®é€‰é¡¹ï¼ˆéœ€äºŒæ¬¡ç¡®è®¤ï¼‰

### S31: å®¡æ‰¹å·¥ä½œæµå¯è§†åŒ–

**ç°çŠ¶**: SafetyStore å·²å®ç°å®¡æ‰¹çŠ¶æ€æœºï¼Œä½†ç¼ºå°‘æµç¨‹å¯è§†åŒ–

**å¢å¼ºå†…å®¹**:
- å¤šæ­¥å®¡æ‰¹è¿›åº¦æ¡
- å®¡æ‰¹å†å²åˆ—è¡¨ï¼ˆæœ€è¿‘ 20 æ¡ï¼‰
- å®¡æ‰¹è¯¦æƒ…æŸ¥çœ‹ï¼ˆç­–ç•¥é…ç½®ã€å®¡æ‰¹æ—¶é—´ï¼‰
- æ’¤é”€å®¡æ‰¹åŠŸèƒ½ï¼ˆä»…é™æœªéƒ¨ç½²ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- 3 æ­¥å®¡æ‰¹æµç¨‹è¿›åº¦æ¸…æ™°å¯è§
- æ¯ä¸ªæ­¥éª¤çš„å®ŒæˆçŠ¶æ€å¯è¿½æº¯
- å†å²è®°å½•å¯ç­›é€‰å’Œæœç´¢
- å®¡æ‰¹ Token æœ‰æ•ˆæœŸå€’è®¡æ—¶æ˜¾ç¤º

### S44: æç«¯è¡Œæƒ…å¤„ç†UI

**ç°çŠ¶**: ç¼ºå°‘å¸‚åœºå¼‚å¸¸æ£€æµ‹å’Œé˜²æŠ¤UI

**å¢å¼ºå†…å®¹**:
- å¸‚åœºå´©ç›˜é¢„è­¦æŒ‡æ ‡å±•ç¤ºï¼ˆæ³¢åŠ¨ç‡ã€æ·±åº¦å˜åŒ–ï¼‰
- è‡ªåŠ¨é˜²æŠ¤æªæ–½é…ç½®é¢æ¿
- ç´§æ€¥é€šçŸ¥æ¨é€ï¼ˆå£°éŸ³ + Toast + NotificationCenterï¼‰
- æç«¯è¡Œæƒ…å†å²äº‹ä»¶è®°å½•

**éªŒæ”¶æ ‡å‡†**:
- æ³¢åŠ¨ç‡è¶…é˜ˆå€¼æ—¶è‡ªåŠ¨è§¦å‘é¢„è­¦
- æä¾›ä¸€é”®å¯ç”¨é˜²æŠ¤æ¨¡å¼
- è®°å½•æ¯æ¬¡æç«¯è¡Œæƒ…äº‹ä»¶
- é˜²æŠ¤æªæ–½æ‰§è¡Œç»“æœå¯æŸ¥

---

## Stories

### Story 7.1: ç†”æ–­å™¨å¯è§†åŒ–ç»„ä»¶

**æ ‡é¢˜**: å®ç°ç†”æ–­å™¨çŠ¶æ€å±•ç¤ºå’Œæ§åˆ¶UI

**æè¿°**:
åˆ›å»º CircuitBreakerPanel ç»„ä»¶ï¼Œå¯è§†åŒ–å±•ç¤ºç†”æ–­å™¨çŠ¶æ€ã€è§¦å‘åŸå› ã€æ¢å¤å€’è®¡æ—¶ï¼Œå¹¶æä¾›æ‰‹åŠ¨é‡ç½®åŠŸèƒ½ã€‚

**éªŒæ”¶æ ‡å‡†**:
- [ ] åˆ›å»º `components/safety/CircuitBreakerPanel.tsx` ç»„ä»¶
- [ ] å±•ç¤ºå½“å‰ç†”æ–­çŠ¶æ€ï¼ˆæœªè§¦å‘/è§¦å‘ä¸­/æ¢å¤ä¸­ï¼‰
- [ ] è§¦å‘æ—¶æ˜¾ç¤ºåŸå› ï¼ˆæ—¥äºæŸ/æ—¶äºæŸ/è¿ç»­äºæŸï¼‰
- [ ] æ˜¾ç¤ºè§¦å‘æ—¶çš„æŒ‡æ ‡å€¼ï¼ˆå¦‚ `-12.5%` è§¦å‘ `-10%` é™é¢ï¼‰
- [ ] è‡ªåŠ¨æ¢å¤æ¨¡å¼ä¸‹æ˜¾ç¤ºå€’è®¡æ—¶
- [ ] æä¾›æ‰‹åŠ¨é‡ç½®æŒ‰é’®ï¼ˆéœ€é•¿æŒ‰ 3 ç§’ç¡®è®¤ï¼‰
- [ ] é›†æˆåˆ° RiskDashboard æˆ– Settings é¡µé¢
- [ ] ç†”æ–­è§¦å‘æ—¶è‡ªåŠ¨æ‰“å¼€é¢æ¿

**ç»„ä»¶è®¾è®¡**:
```tsx
interface CircuitBreakerPanelProps {
  /** æ˜¯å¦è‡ªåŠ¨å±•å¼€ï¼ˆç†”æ–­è§¦å‘æ—¶ï¼‰ */
  autoExpand?: boolean
  /** å±•ç¤ºæ¨¡å¼ï¼šå®Œæ•´/ç´§å‡‘ */
  mode?: 'full' | 'compact'
  /** è‡ªå®šä¹‰ç±»å */
  className?: string
}

// ä½¿ç”¨ç¤ºä¾‹
<CircuitBreakerPanel
  autoExpand={circuitBreakerStatus.triggered}
  mode="full"
/>
```

---

### Story 7.2: å®¡æ‰¹å†å²è®°å½•ç»„ä»¶

**æ ‡é¢˜**: å®ç°å®¡æ‰¹å†å²æŸ¥çœ‹å’Œç®¡ç†UI

**æè¿°**:
åˆ›å»º ApprovalHistory ç»„ä»¶ï¼Œå±•ç¤ºæ‰€æœ‰ Live éƒ¨ç½²çš„å®¡æ‰¹è®°å½•ï¼Œæ”¯æŒæŸ¥çœ‹è¯¦æƒ…ã€æœç´¢ç­›é€‰ã€‚

**éªŒæ”¶æ ‡å‡†**:
- [ ] åˆ›å»º `components/deployment/ApprovalHistory.tsx` ç»„ä»¶
- [ ] å±•ç¤ºå®¡æ‰¹è®°å½•åˆ—è¡¨ï¼ˆç­–ç•¥åã€å®¡æ‰¹æ—¶é—´ã€ä½¿ç”¨èµ„é‡‘ï¼‰
- [ ] æ”¯æŒæŒ‰æ—¶é—´å€’åº/æ­£åºæ’åº
- [ ] æ”¯æŒæŒ‰ç­–ç•¥åæœç´¢
- [ ] ç‚¹å‡»è®°å½•æŸ¥çœ‹è¯¦æƒ…ï¼ˆå®Œæ•´ç­–ç•¥é…ç½®ã€å®¡æ‰¹æ­¥éª¤ï¼‰
- [ ] æ˜¾ç¤ºå®¡æ‰¹ Token çŠ¶æ€ï¼ˆæœ‰æ•ˆ/å·²è¿‡æœŸï¼‰
- [ ] å¯¹äºæœªéƒ¨ç½²çš„å®¡æ‰¹ï¼Œæä¾›æ’¤é”€é€‰é¡¹
- [ ] é›†æˆåˆ° Settings æˆ– Deployment é¡µé¢
- [ ] æœ€å¤šä¿ç•™ 100 æ¡å†å²è®°å½•

**ç»„ä»¶è®¾è®¡**:
```tsx
interface ApprovalHistoryProps {
  /** æœ€å¤§æ˜¾ç¤ºæ¡æ•° */
  maxRecords?: number
  /** æ˜¯å¦æ˜¾ç¤ºæ“ä½œæŒ‰é’®ï¼ˆæ’¤é”€ï¼‰ */
  showActions?: boolean
  /** è‡ªå®šä¹‰ç±»å */
  className?: string
}

// ApprovalRecord è¯¦æƒ…å¼¹çª—
interface ApprovalDetailModalProps {
  record: ApprovalRecord
  isOpen: boolean
  onClose: () => void
  onRevoke?: (recordId: string) => void
}
```

---

### Story 7.3: æç«¯è¡Œæƒ…ç›‘æµ‹é¢æ¿

**æ ‡é¢˜**: å®ç°å¸‚åœºå¼‚å¸¸æ£€æµ‹å’Œé˜²æŠ¤UI

**æè¿°**:
åˆ›å»º ExtremeMarketPanel ç»„ä»¶ï¼Œç›‘æµ‹å¸‚åœºå¼‚å¸¸æŒ‡æ ‡ï¼ˆæ³¢åŠ¨ç‡ã€æ·±åº¦éª¤å˜ï¼‰ï¼Œæä¾›é˜²æŠ¤æªæ–½é…ç½®å’Œå†å²äº‹ä»¶è®°å½•ã€‚

**éªŒæ”¶æ ‡å‡†**:
- [ ] åˆ›å»º `components/safety/ExtremeMarketPanel.tsx` ç»„ä»¶
- [ ] ç›‘æµ‹æŒ‡æ ‡ï¼š
  - çŸ­æœŸæ³¢åŠ¨ç‡ï¼ˆ5 åˆ†é’Ÿå†…ä»·æ ¼æ³¢åŠ¨ > 5%ï¼‰
  - è®¢å•ç°¿æ·±åº¦éª¤é™ï¼ˆä¹°å–ç›˜æ·±åº¦ä¸‹é™ > 70%ï¼‰
  - å¼‚å¸¸äº¤æ˜“é‡ï¼ˆæˆäº¤é‡ 10 å€äºå‡å€¼ï¼‰
- [ ] å®æ—¶æ˜¾ç¤ºç›‘æµ‹æŒ‡æ ‡å½“å‰å€¼
- [ ] é…ç½®é˜²æŠ¤é˜ˆå€¼ï¼ˆå¯è‡ªå®šä¹‰è§¦å‘æ¡ä»¶ï¼‰
- [ ] é˜²æŠ¤æªæ–½é€‰é¡¹ï¼š
  - è‡ªåŠ¨æš‚åœæ‰€æœ‰ç­–ç•¥
  - è‡ªåŠ¨å–æ¶ˆæŒ‚å•
  - ä»…å‘é€é€šçŸ¥ï¼ˆä¸è‡ªåŠ¨æ“ä½œï¼‰
- [ ] æç«¯è¡Œæƒ…äº‹ä»¶å†å²ï¼ˆæœ€è¿‘ 20 æ¡ï¼‰
- [ ] äº‹ä»¶è§¦å‘æ—¶ï¼šToast é€šçŸ¥ + å£°éŸ³è­¦æŠ¥ + NotificationCenter è®°å½•
- [ ] é›†æˆåˆ° MonitorCanvas ä¾§è¾¹æ æˆ–ç‹¬ç«‹é¡µé¢

**ç»„ä»¶è®¾è®¡**:
```tsx
interface ExtremeMarketPanelProps {
  /** ç›‘æ§äº¤æ˜“å¯¹ */
  symbol: string
  /** æ˜¯å¦å¯ç”¨å£°éŸ³è­¦æŠ¥ */
  soundEnabled?: boolean
  /** è‡ªå®šä¹‰ç±»å */
  className?: string
}

interface ExtremeMarketConfig {
  enabled: boolean
  volatilityThreshold: number      // æ³¢åŠ¨ç‡é˜ˆå€¼ (%)
  depthDropThreshold: number       // æ·±åº¦ä¸‹é™é˜ˆå€¼ (%)
  volumeSpikeMultiplier: number    // äº¤æ˜“é‡å€æ•°
  autoProtectionMode: 'pause_all' | 'cancel_orders' | 'notify_only'
}

interface ExtremeMarketEvent {
  id: string
  timestamp: number
  symbol: string
  triggerReason: 'volatility' | 'depth_drop' | 'volume_spike'
  triggerValue: number
  protectionAction: string
}
```

---

## é›†æˆè®¡åˆ’

### Header é›†æˆ

```tsx
// components/layout/Header.tsx
export function Header() {
  const circuitBreakerStatus = useSafetyStore(selectCircuitBreakerStatus)
  const [showCBPanel, setShowCBPanel] = useState(false)

  return (
    <header>
      {/* ç°æœ‰ç»„ä»¶: KillSwitch, MarginAlert */}

      {/* æ–°å¢: ç†”æ–­å™¨çŠ¶æ€æŒ‡ç¤ºå™¨ */}
      {circuitBreakerStatus.triggered && (
        <Button
          variant="destructive"
          onClick={() => setShowCBPanel(true)}
        >
          <AlertTriangle className="h-4 w-4" />
          ç†”æ–­ä¸­
        </Button>
      )}
    </header>
  )
}
```

### Settings é¡µé¢é›†æˆ

```tsx
// app/settings/page.tsx
export default function SettingsPage() {
  return (
    <Tabs defaultValue="general">
      <TabsList>
        <TabsTrigger value="safety">å®‰å…¨è®¾ç½®</TabsTrigger>
      </TabsList>

      <TabsContent value="safety">
        <CircuitBreakerPanel mode="full" />
        <ApprovalHistory maxRecords={50} showActions />
        <ExtremeMarketPanel symbol="BTC/USDT" />
      </TabsContent>
    </Tabs>
  )
}
```

### MonitorCanvas ä¾§è¾¹æ é›†æˆ

```tsx
// components/canvas/MonitorCanvas.tsx - å³ä¾§è¾¹æ 
<aside className="w-80 border-l">
  <Tabs>
    <TabsList>
      <TabsTrigger value="alerts">è­¦æŠ¥</TabsTrigger>
      <TabsTrigger value="protection">é˜²æŠ¤</TabsTrigger>
    </TabsList>

    <TabsContent value="alerts">
      <MarginAlert compact />
      <SentinelAlerts />
    </TabsContent>

    <TabsContent value="protection">
      <ExtremeMarketPanel symbol={activeSymbol} />
    </TabsContent>
  </Tabs>
</aside>
```

---

## UI è®¾è®¡è§„èŒƒ

### ç†”æ–­å™¨é¢æ¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš ï¸ ç†”æ–­å™¨çŠ¶æ€                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  çŠ¶æ€: ğŸ”´ è§¦å‘ä¸­                         â”‚
â”‚  è§¦å‘åŸå› : æ—¥äºæŸè¶…é™                     â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ è§¦å‘æŒ‡æ ‡                           â”‚  â”‚
â”‚  â”‚ å½“å‰æ—¥äºæŸ: -12.5%                 â”‚  â”‚
â”‚  â”‚ é™åˆ¶é˜ˆå€¼:   -10.0%                 â”‚  â”‚
â”‚  â”‚ è§¦å‘æ—¶é—´: 2025-12-26 14:30         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  è‡ªåŠ¨æ¢å¤: 30 åˆ†é’Ÿå                     â”‚
â”‚  â±ï¸ å‰©ä½™æ—¶é—´: 18:23                     â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  [é•¿æŒ‰ 3 ç§’æ‰‹åŠ¨é‡ç½®]             â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  [ æŸ¥çœ‹å†å² ]                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®¡æ‰¹å†å²åˆ—è¡¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“‹ å®¡æ‰¹å†å²                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  [æœç´¢ç­–ç•¥å...] ğŸ”   [â¬‡ï¸ æ—¶é—´å€’åº]     â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ BTC è¶‹åŠ¿ç­–ç•¥ v2                   â”‚  â”‚
â”‚  â”‚ èµ„é‡‘: $5,000  â€¢  2025-12-25 10:30 â”‚  â”‚
â”‚  â”‚ âœ… å·²éƒ¨ç½²  â€¢  Token å·²è¿‡æœŸ         â”‚  â”‚
â”‚  â”‚          [ æŸ¥çœ‹è¯¦æƒ… ]             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ETH ç½‘æ ¼ç­–ç•¥                      â”‚  â”‚
â”‚  â”‚ èµ„é‡‘: $2,000  â€¢  2025-12-24 15:45 â”‚  â”‚
â”‚  â”‚ â³ æœªéƒ¨ç½²  â€¢  Token æœ‰æ•ˆ (2:15)   â”‚  â”‚
â”‚  â”‚   [ æŸ¥çœ‹è¯¦æƒ… ]  [ æ’¤é”€å®¡æ‰¹ ]      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  å…± 18 æ¡è®°å½•                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æç«¯è¡Œæƒ…é¢æ¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸŒªï¸ æç«¯è¡Œæƒ…ç›‘æµ‹ - BTC/USDT             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  ç›‘æµ‹æŒ‡æ ‡                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ æ³¢åŠ¨ç‡ (5åˆ†é’Ÿ): 2.3% / 5.0%       â”‚  â”‚
â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ å®‰å…¨         â”‚  â”‚
â”‚  â”‚                                   â”‚  â”‚
â”‚  â”‚ è®¢å•ç°¿æ·±åº¦: -15% / -70%           â”‚  â”‚
â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ æ­£å¸¸         â”‚  â”‚
â”‚  â”‚                                   â”‚  â”‚
â”‚  â”‚ äº¤æ˜“é‡å€æ•°: 2.1x / 10x            â”‚  â”‚
â”‚  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ æ­£å¸¸         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  é˜²æŠ¤è®¾ç½®                                â”‚
â”‚  â˜‘ï¸ å¯ç”¨è‡ªåŠ¨é˜²æŠ¤                        â”‚
â”‚  é˜²æŠ¤æªæ–½: [æš‚åœæ‰€æœ‰ç­–ç•¥ â–¼]             â”‚
â”‚  å£°éŸ³è­¦æŠ¥: [ğŸ”” å¼€å¯]                    â”‚
â”‚                                         â”‚
â”‚  æœ€è¿‘äº‹ä»¶ (3)                            â”‚
â”‚  â€¢ 2025-12-25 22:15 - æ³¢åŠ¨ç‡è¶…é™ (8.2%)â”‚
â”‚  â€¢ 2025-12-23 03:40 - æ·±åº¦éª¤é™ (-82%) â”‚
â”‚  â€¢ 2025-12-20 14:22 - äº¤æ˜“é‡æ¿€å¢ (15x)â”‚
â”‚                                         â”‚
â”‚  [ æŸ¥çœ‹æ‰€æœ‰äº‹ä»¶ ]                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é»˜è®¤é…ç½®

```typescript
// æç«¯è¡Œæƒ…ç›‘æµ‹é»˜è®¤é…ç½®
const DEFAULT_EXTREME_MARKET_CONFIG: ExtremeMarketConfig = {
  enabled: true,
  volatilityThreshold: 5.0,          // 5 åˆ†é’Ÿæ³¢åŠ¨ > 5%
  depthDropThreshold: 70,            // æ·±åº¦ä¸‹é™ > 70%
  volumeSpikeMultiplier: 10,         // äº¤æ˜“é‡ > 10x å‡å€¼
  autoProtectionMode: 'notify_only', // é»˜è®¤ä»…é€šçŸ¥
}

// å®¡æ‰¹å†å²ä¿ç•™é…ç½®
const APPROVAL_HISTORY_CONFIG = {
  maxRecords: 100,              // æœ€å¤šä¿ç•™ 100 æ¡
  tokenValidityMinutes: 5,      // Token æœ‰æ•ˆæœŸ 5 åˆ†é’Ÿ
  allowRevokeBeforeDeploy: true,// å…è®¸æ’¤é”€æœªéƒ¨ç½²å®¡æ‰¹
}

// ç†”æ–­å™¨UIé…ç½®
const CIRCUIT_BREAKER_UI_CONFIG = {
  autoExpandOnTrigger: true,    // è§¦å‘æ—¶è‡ªåŠ¨å±•å¼€
  manualResetConfirmSeconds: 3, // æ‰‹åŠ¨é‡ç½®éœ€ 3 ç§’é•¿æŒ‰
  showTriggerMetrics: true,     // æ˜¾ç¤ºè§¦å‘æŒ‡æ ‡è¯¦æƒ…
}
```

---

## å…¼å®¹æ€§è¦æ±‚

- [ ] å¤ç”¨ç°æœ‰ SafetyStore çŠ¶æ€ï¼Œä¸ä¿®æ”¹ç°æœ‰ API
- [ ] ä¸ KillSwitch/MarginAlert ç»„ä»¶æ ·å¼ä¸€è‡´
- [ ] éµå¾ªç°æœ‰ Shadcn/ui ç»„ä»¶æ¨¡å¼
- [ ] ä¸å½±å“ EPIC-008 å·²å®ç°åŠŸèƒ½
- [ ] é€šçŸ¥ç³»ç»Ÿå¤ç”¨ NotificationCenter å’Œ Toast

---

## é£é™©ç¼“è§£

**ä¸»è¦é£é™©**: ç†”æ–­å™¨UIä¸åç«¯ç†”æ–­é€»è¾‘ä¸åŒæ­¥

**ç¼“è§£æ–¹æ¡ˆ**:
- ç»„ä»¶ç›´æ¥è®¢é˜… SafetyStore çŠ¶æ€
- ä¸åœ¨UIå±‚å®ç°ç†”æ–­åˆ¤æ–­é€»è¾‘
- æ‰€æœ‰æ“ä½œé€šè¿‡ Store Actions æ‰§è¡Œ

**å›æ»šè®¡åˆ’**:
- æ–°å¢ç»„ä»¶å¯å•ç‹¬ç¦ç”¨
- ä¸å½±å“ç°æœ‰ SafetyStore æ ¸å¿ƒåŠŸèƒ½
- ç§»é™¤æ–°å¢è·¯ç”±å³å¯å›æ»š

---

## Definition of Done

- [ ] Story 7.1: CircuitBreakerPanel å®Œæˆå¹¶é›†æˆ
- [ ] Story 7.2: ApprovalHistory å®Œæˆå¹¶é›†æˆ
- [ ] Story 7.3: ExtremeMarketPanel å®Œæˆå¹¶é›†æˆ
- [ ] æ‰€æœ‰ç»„ä»¶éµå¾ªç°æœ‰è®¾è®¡æ¨¡å¼
- [ ] é€šè¿‡ TypeScript ç±»å‹æ£€æŸ¥
- [ ] ä¸ç°æœ‰å®‰å…¨åŠŸèƒ½æ— å†²çª
- [ ] ç”¨æˆ·å¯é€šè¿‡ UI å®Œæˆæ‰€æœ‰é£æ§æ“ä½œ
- [ ] æ—  P0/P1 Bug

---

## éªŒè¯æ¸…å•

### èŒƒå›´éªŒè¯
- [x] Epic å¯åœ¨ 3 ä¸ª Stories å†…å®Œæˆ
- [x] æ— éœ€ä¿®æ”¹ç°æœ‰ SafetyStore API
- [x] éµå¾ªç°æœ‰ components/safety ç»„ä»¶æ¨¡å¼
- [x] å¤ç”¨ Shadcn/ui åŸºç¡€ç»„ä»¶

### é£é™©è¯„ä¼°
- [x] å¯¹ç°æœ‰ç³»ç»Ÿé£é™©: ä½ (çº¯UIå¢å¼º)
- [x] SafetyStore å·²æœ‰ç†”æ–­å’Œå®¡æ‰¹é€»è¾‘
- [x] å›æ»šæ–¹æ¡ˆå¯è¡Œ (ç§»é™¤æ–°ç»„ä»¶å³å¯)
- [x] å›¢é˜Ÿç†Ÿæ‚‰ React ç»„ä»¶å¼€å‘

---

**åˆ›å»ºæ—¶é—´**: 2025-12-26
**åˆ›å»ºè€…**: BMad Analyst Agent
**æ¥æº**: V3 è®¾è®¡æ–‡æ¡£ S29/S31/S44
**ä¾èµ–**: EPIC-008 (Safety Critical Features), EPIC-005 (Notification System)
